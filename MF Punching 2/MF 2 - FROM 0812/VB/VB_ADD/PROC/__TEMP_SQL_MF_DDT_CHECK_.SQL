SELECT COUNT(*) INTO IS_VALID_DT
FROM TB_DOC_UPLOAD A, BRANCH_MASTER B 
WHERE A.BUSI_BRANCH_CODE = B.BRANCH_CODE 
AND COMMON_ID = TRIM(P_COMMON_ID) 
AND TRAN_TYPE = 'MF' 
AND VERIFICATION_FLAG = '1' 
AND REJECTION_STATUS = '0'  
AND PUNCHING_FLAG = '1' 
AND ROWNUM = 1;

IF IS_VALID_DT <= 0 THEN
    SELECT 
        CASE WHEN TRAN_TYPE <> 'MF' THEN 'DT IS NOT A VALID MF'
                WHEN VERIFICATION_FLAG <> '1' THEN 'DT IS NOT VERIFIED'
                WHEN REJECTION_STATUS <> '1' THEN 'DT IS REJECTED'
                WHEN PUNCHING_FLAG <> '0' THEN 'DT IS PUNCHED'
                ELSE 'INCORRECT DT'
        END INTO V_INVALID_SQL
    FROM TB_DOC_UPLOAD A, BRANCH_MASTER B
    WHERE A.BUSI_BRANCH_CODE = B.BRANCH_CODE
    AND COMMON_ID = TRIM(P_COMMON_ID)
    AND ROWNUM = 1;
END IF;