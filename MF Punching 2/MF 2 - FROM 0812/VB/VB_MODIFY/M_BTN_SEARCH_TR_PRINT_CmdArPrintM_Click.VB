Private Sub CmdArPrintM_Click()
If MyPrintTranCode = "" Then
   MsgBox "Double Click The Record Which You Want To Print"
   Exit Sub
End If
If Mid(Trim(TxtClientCodeM), 1, 1) = "4" Then
    sql = " CREATE OR REPLACE VIEW armf AS SELECT 'P' ar_type, t.tran_code, TR_DATE, CHEQUE_DATE cheque_date, "
    sql = sql & "          CHEQUE_NO cheque_no, t.bank_name, amount, b.client_code source_code, "
    sql = sql & "          app_no, NVL (upfront_ope_paid_temptran (t.tran_code), 0) paid_brok, "
    sql = sql & "          NVL ((SELECT SUM (NVL (amt, 0)) "
    sql = sql & "                  FROM payment_detail "
    sql = sql & "                 WHERE tran_code = t.tran_code), 0) paidamt, '' asr, PAYMENT_MODE, "
    sql = sql & "          investor_name inv, (SELECT MAX (client_name) "
    sql = sql & "                                FROM client_master "
    sql = sql & "                               WHERE client_code = t.source_code) client, "
    sql = sql & "          exist_code as existcode, "
    sql = sql & "           address1  add1, "
    sql = sql & "          address2 add2, '' loc, "
    sql = sql & "          pincode pin, "
    sql = sql & "          (SELECT MAX (city_name) "
    sql = sql & "             FROM city_master "
    sql = sql & "            WHERE city_id = (SELECT MAX (city_id) "
    sql = sql & "                               FROM client_master "
    sql = sql & "                              WHERE client_code = t.source_code)) ccity, "
    sql = sql & "          mobile ph, "
    sql = sql & "           email, 0 arn, '' subbroker, "
    sql = sql & "          (SELECT rm_name "
    sql = sql & "             FROM employee_master "
    sql = sql & "            WHERE payroll_id = TO_CHAR (t.BUSINESS_RMCODE) "
    sql = sql & "              AND (TYPE = 'A' OR TYPE IS NULL)) rname, "
    sql = sql & "          (SELECT payroll_id "
    sql = sql & "             FROM employee_master "
    sql = sql & "            WHERE payroll_id = TO_CHAR (t.BUSINESS_RMCODE) "
    sql = sql & "              AND (TYPE = 'A' OR TYPE IS NULL)) rcode, "
    sql = sql & "          (SELECT branch_name "
    sql = sql & "             FROM branch_master "
    sql = sql & "            WHERE branch_code = t.BUSI_BRANCH_CODE) bname, "
    sql = sql & "          (SELECT address1 "
    sql = sql & "             FROM branch_master "
    sql = sql & "            WHERE branch_code = t.BUSI_BRANCH_CODE) badd1, "
    sql = sql & "          (SELECT address2 "
    sql = sql & "             FROM branch_master "
    sql = sql & "            WHERE branch_code = t.BUSI_BRANCH_CODE) badd2, "
    sql = sql & "          (SELECT phone "
    sql = sql & "             FROM branch_master "
    sql = sql & "            WHERE branch_code = t.BUSI_BRANCH_CODE) bphone, "
    sql = sql & "          (SELECT location_name "
    sql = sql & "             FROM location_master "
    sql = sql & "            WHERE location_id = (SELECT location_id "
    sql = sql & "                                   FROM branch_master "
    sql = sql & "                                  WHERE branch_code = t.BUSI_BRANCH_CODE)) bloc, "
    sql = sql & "          (SELECT city_name "
    sql = sql & "             FROM city_master "
    sql = sql & "            WHERE city_id = (SELECT city_id "
    sql = sql & "                               FROM branch_master "
    sql = sql & "                              WHERE branch_code = t.BUSI_BRANCH_CODE)) bcity, "
    sql = sql & "          (SELECT mut_name "
    sql = sql & "             FROM mut_fund "
    sql = sql & "            WHERE mut_code = t.MUT_CODE) compmf, "
    sql = sql & "          'Bajaj Capital Limited' compgroup, "
    sql = sql & "          (SELECT sch_name "
    sql = sql & "             FROM scheme_info "
    sql = sql & "            WHERE sch_code = t.SCH_CODE) schmf, "
    sql = sql & "          (SELECT short_name "
    sql = sql & "             FROM scheme_info "
    sql = sql & "            WHERE sch_code = t.SCH_CODE) sschmf  "
    sql = sql & " , ('" & Glbloginid & "') LOGGEDUSERID "
    sql = sql & "     FROM transaction_mf_Temp1 t,client_master b "
    sql = sql & "    WHERE t.source_code=b.client_code and TR_DATE = to_date('" & MyDate(ImEntryDtM) & "','mm/dd/yyyy')"
    sql = sql & "      AND MOVE_FLAG1 IS NULL "
    sql = sql & "      AND (asa <> 'C' OR asa IS NULL) "
    sql = sql & "      AND BUSINESS_RMCODE = " & Val(TxtBusiCodeM.Text) & " "
    sql = sql & "      AND SOURCE_CODE = '" & TxtClientCodeM.Text & "' "
    If MsgBox("Multiple Transactions Print?", vbYesNo) = vbNo Then
        sql = sql & "      AND tran_code = '" & MyPrintTranCode & "' "
    End If
Else
    sql = " CREATE OR REPLACE VIEW armf AS SELECT b.agent_code,'P' ar_type, t.tran_code, TR_DATE, CHEQUE_DATE cheque_date, "
    sql = sql & "          CHEQUE_NO cheque_no, t.bank_name, amount, b.agent_code source_code, "
    sql = sql & "          app_no, NVL (upfront_ope_paid_temptran (t.tran_code), 0) paid_brok, "
    sql = sql & "          NVL ((SELECT SUM (NVL (amt, 0)) "
    sql = sql & "                  FROM payment_detail "
    sql = sql & "                 WHERE tran_code = t.tran_code), 0) paidamt, '' asr, PAYMENT_MODE, "
    sql = sql & "          investor_name inv, (SELECT MAX (agent_name) "
    sql = sql & "                                FROM agent_master "
    sql = sql & "                               WHERE agent_code = t.source_code) client, "
    sql = sql & "          exist_code as existcode, "
    sql = sql & "           address1  add1, "
    sql = sql & "          address2 add2, '' loc, "
    sql = sql & "          pincode pin, "
    sql = sql & "          (SELECT MAX (city_name) "
    sql = sql & "             FROM city_master "
    sql = sql & "            WHERE city_id = (SELECT MAX (city_id) "
    sql = sql & "                               FROM agent_master "
    sql = sql & "                              WHERE agent_code = t.source_code)) ccity, "
    sql = sql & "          mobile ph, "
    sql = sql & "           email, 0 arn, '' subbroker, "
    sql = sql & "          (SELECT rm_name "
    sql = sql & "             FROM employee_master "
    sql = sql & "            WHERE payroll_id = TO_CHAR (t.BUSINESS_RMCODE) "
    sql = sql & "              AND (TYPE = 'A' OR TYPE IS NULL)) rname, "
    sql = sql & "          (SELECT payroll_id "
    sql = sql & "             FROM employee_master "
    sql = sql & "            WHERE payroll_id = TO_CHAR (t.BUSINESS_RMCODE) "
    sql = sql & "              AND (TYPE = 'A' OR TYPE IS NULL)) rcode, "
    sql = sql & "          (SELECT branch_name "
    sql = sql & "             FROM branch_master "
    sql = sql & "            WHERE branch_code = t.BUSI_BRANCH_CODE) bname, "
    sql = sql & "          (SELECT address1 "
    sql = sql & "             FROM branch_master "
    sql = sql & "            WHERE branch_code = t.BUSI_BRANCH_CODE) badd1, "
    sql = sql & "          (SELECT address2 "
    sql = sql & "             FROM branch_master "
    sql = sql & "            WHERE branch_code = t.BUSI_BRANCH_CODE) badd2, "
    sql = sql & "          (SELECT phone "
    sql = sql & "             FROM branch_master "
    sql = sql & "            WHERE branch_code = t.BUSI_BRANCH_CODE) bphone, "
    sql = sql & "          (SELECT location_name "
    sql = sql & "             FROM location_master "
    sql = sql & "            WHERE location_id = (SELECT location_id "
    sql = sql & "                                   FROM branch_master "
    sql = sql & "                                  WHERE branch_code = t.BUSI_BRANCH_CODE)) bloc, "
    sql = sql & "          (SELECT city_name "
    sql = sql & "             FROM city_master "
    sql = sql & "            WHERE city_id = (SELECT city_id "
    sql = sql & "                               FROM branch_master "
    sql = sql & "                              WHERE branch_code = t.BUSI_BRANCH_CODE)) bcity, "
    sql = sql & "          (SELECT mut_name "
    sql = sql & "             FROM mut_fund "
    sql = sql & "            WHERE mut_code = t.MUT_CODE) compmf, "
    sql = sql & "          'Bajaj Capital Limited' compgroup, "
    sql = sql & "          (SELECT sch_name "
    sql = sql & "             FROM scheme_info "
    sql = sql & "            WHERE sch_code = t.SCH_CODE) schmf, "
    sql = sql & "          (SELECT short_name "
    sql = sql & "             FROM scheme_info "
    sql = sql & "            WHERE sch_code = t.SCH_CODE) sschmf  "
    sql = sql & " , ('" & Glbloginid & "') LOGGEDUSERID "
    sql = sql & "     FROM transaction_mf_Temp1 t,agent_master b "
    sql = sql & "    WHERE t.source_code=b.agent_code and TR_DATE = to_date('" & MyDate(ImEntryDtM) & "','mm/dd/yyyy')"
    sql = sql & "      AND MOVE_FLAG1 IS NULL "
    sql = sql & "      AND (asa <> 'C' OR asa IS NULL) "
    sql = sql & "      AND BUSINESS_RMCODE = " & Val(TxtBusiCodeM.Text) & " "
    sql = sql & "      AND SOURCE_CODE = '" & TxtClientCodeM.Text & "' "
    If MsgBox("Multiple Transactions Print?", vbYesNo) = vbNo Then
        sql = sql & "      AND tran_code = '" & MyPrintTranCode & "' "
    End If
End If
MyConn.Execute sql
CrystalReport1.Reset
CrystalReport1.Connect = MyConn
CrystalReport1.LogOnServer "pdsodbc.dll", "TEST", "wealthmaker", "wealthmaker", DataBasePassword
CrystalReport1.ReportFileName = App.Path & "\Reports\MFAr1.rpt"
CrystalReport1.WindowState = crptMaximized
CrystalReport1.WindowShowPrintSetupBtn = True
CrystalReport1.WindowShowSearchBtn = True
CrystalReport1.WindowShowPrintBtn = True
CrystalReport1.action = 1
End Sub

