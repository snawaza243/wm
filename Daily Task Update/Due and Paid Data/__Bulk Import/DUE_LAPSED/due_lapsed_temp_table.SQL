-- Temporary tables (create once)
CREATE GLOBAL TEMPORARY TABLE TEMP_LAPSED_POLICIES (
    policy_no VARCHAR2(50),
    company_cd VARCHAR2(50)
) ON COMMIT PRESERVE ROWS;

CREATE GLOBAL TEMPORARY TABLE TEMP_LAPSED_UPDATES (
    policy_no VARCHAR2(50),
    company_cd VARCHAR2(50),
    due_date DATE
) ON COMMIT PRESERVE ROWS;