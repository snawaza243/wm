CREATE OR REPLACE PROCEDURE WEALTHMAKER.PSM_AO_AR_BY_AHINV (
    p_client_codekyc    IN VARCHAR2,
    p_client_code       IN VARCHAR2,
    result_cursor OUT SYS_REFCURSOR
)
AS
BEGIN
    -- Open a cursor for the result set
    OPEN result_cursor FOR
    SELECT
        'Valid Data'          as message,
        a.TRAN_CODE as TRAN_CODE,
           a.TR_DATE as TR_DATE,
           a.CLIENT_CODE as CLIENT_CODE,
           a.MUT_CODE as MUT_CODE,
           a.SCH_CODE as SCH_CODE,
           a.APP_NO as APP_NO,
           a.FOLIO_NO as FOLIO_NO,
           a.TRAN_TYPE as TRAN_TYPE,
           a.REF_TRAN_CODE as REF_TRAN_CODE,
           a.AMOUNT as AMOUNT,
           a.UNITS as UNITS,
           a.RATE as RATE,
           a.APP_DATE as APP_DATE,
           a.BRANCH_CODE as BRANCH_CODE,
           a.SOURCE_CODE as SOURCE_CODE,
           a.RE_INVT as RE_INVT,
           a.NEW_FROM_BROK_STAT as NEW_FROM_BROK_STAT,
           a.NAV_DATE as NAV_DATE,
           a.PAYMENT_MODE as PAYMENT_MODE,
           a.CHEQUE_DATE as CHEQUE_DATE,
           a.CHEQUE_NO as CHEQUE_NO,
           a.BANK_NAME as BANK_NAME,
           a.BANK_BRANCH as BANK_BRANCH,
           a.BANK_AC_NO as BANK_AC_NO,
           a.ASR as ASR,
           a.ASA as ASA,
           a.BROKER_ID as BROKER_ID,
           a.BROK_CAL as BROK_CAL,
           a.INVESTOR_TYPE as INVESTOR_TYPE,
           a.SWITCH_SCHEME as SWITCH_SCHEME,
           a.SWITCH_FOLIO as SWITCH_FOLIO,
           a.INTER as INTER,
           a.SWITCH_TRANCODE as SWITCH_TRANCODE,
           a.RMCODE as RMCODE,
           a.BILL_GEN as BILL_GEN,
           a.SYS_TRAN as SYS_TRAN,
           a.MANUAL_ARNO as MANUAL_ARNO,
           a.CHALLAN_FL as CHALLAN_FL,
           a.BUSINESS_RMCODE as BUSINESS_RMCODE,
           a.TRAN_ID as TRAN_ID,
           a.LOGGEDUSERID as LOGGEDUSERID,
           a.TIMEST as TIMEST,
           a.REMARK as REMARK,
           a.FLAG as FLAG,
           a.IMP_DATE as IMP_DATE,
           a.TRAN_UPDATE as TRAN_UPDATE,
           a.BUSI_BRANCH_CODE as BUSI_BRANCH_CODE,
           a.REG_DATE as REG_DATE,
           a.MODIFY_USER as MODIFY_USER,
           a.MODIFY_DATE as MODIFY_DATE,
           a.FAMILY_HEAD as FAMILY_HEAD,
           a.FPF_DATE as FPF_DATE,
           a.FPL_DATE as FPL_DATE,
           a.CH_RECO as CH_RECO,
           a.POSTED as POSTED,
           a.REG_TRANTYPE as REG_TRANTYPE,
           a.CROR_PLANNO as CROR_PLANNO,
           a.CROR_DATE as CROR_DATE,
           a.AUDIT_FPDATE as AUDIT_FPDATE,
           a.PLAN_TYPE as PLAN_TYPE,
           a.REG_SUBBROK as REG_SUBBROK,
           a.SEQ_NO as SEQ_NO,
           a.REG_TRAN_FLAG as REG_TRAN_FLAG,
           a.AUM_FLAG as AUM_FLAG,
           a.INV_NAME as INV_NAME,
           a.PORTFOLIO_FLAG as PORTFOLIO_FLAG,
           a.DUP_FLAG as DUP_FLAG,
           a.DUP_FLAG1 as DUP_FLAG1,
           a.DUP_FLAG2 as DUP_FLAG2,
           a.UNIQUE_ID as UNIQUE_ID,
           a.AUTOMAP_FLAG as AUTOMAP_FLAG,
           a.FP_STATUS as FP_STATUS,
           a.MODIFY_TALISMA as MODIFY_TALISMA,
           a.TRAN_SRC as TRAN_SRC,
           b.client_codekyc as b_client_codekyc,
           b.CLIENT_code   as  b_act_code,
           a.client_code        as a_client_code,
           client_pan
      FROM transaction_st a, client_test b
     WHERE remark = 'ADVISORY' AND a.client_code = p_client_codekyc and rownum = 1;
 END;
/
