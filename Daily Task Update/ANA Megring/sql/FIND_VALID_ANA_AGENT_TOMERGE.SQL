SELECT INVESTOR_NAME,PAN,BRANCH_CODE,COUNT(DISTINCT SOURCE_ID) FROM WEALTHMAKER.INVESTOR_MASTER WHERE INV_CODE LIKE '3%'
GROUP BY BRANCH_CODE,INVESTOR_NAME,PAN HAVING COUNT(DISTINCT SOURCE_ID)=2 ;


SELECT
(SELECT AGENT_CODE FROM WEALTHMAKER.AGENT_MASTER WHERE AGENT_CODE=T.SOURCE_ID) AGENT_CODE,
(SELECT AGENT_NAME FROM WEALTHMAKER.AGENT_MASTER WHERE AGENT_CODE=T.SOURCE_ID) AGENT_NAME,
(SELECT EXIST_CODE FROM WEALTHMAKER.AGENT_MASTER WHERE AGENT_CODE=T.SOURCE_ID) EXIST_CODE,
T.*
FROM WEALTHMAKER.INVESTOR_MASTER T WHERE INVESTOR_NAME='KHORSHED N GHEEWALA' AND INV_CODE LIKE '3%';