CREATE OR REPLACE PROCEDURE WEALTHMAKER.PSM_GET_NPS_TEMP_DATA(
    P_IMP_TYPE IN VARCHAR2,  -- 'ECS' or 'NON_ECS'
    P_CURSOR OUT SYS_REFCURSOR
) AS
BEGIN
    IF P_IMP_TYPE = 'NON_ECS' THEN
        OPEN P_CURSOR FOR SELECT CONSUMER_CODE, TR_DATE, REMARK FROM WEALTHMAKER.PSM_NPS_NES_TBL_TEMP1;
    ELSIF P_IMP_TYPE = 'ECS' THEN
        OPEN P_CURSOR FOR SELECT CONSUMER_CODE, TR_DATE, REMARK FROM WEALTHMAKER.PSM_NPS_NES_TBL_TEMP2;
    ELSE
        OPEN P_CURSOR FOR SELECT 'ERROR: Invalid import type specified' AS MESSAGE FROM DUAL;
    END IF;
EXCEPTION
    WHEN OTHERS THEN
        OPEN P_CURSOR FOR SELECT 'ERROR: PSM_GET_NPS_TEMP_DATA' AS MESSAGE FROM DUAL;
END;
/