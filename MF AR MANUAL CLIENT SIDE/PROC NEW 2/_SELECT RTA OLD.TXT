  SELECT   FOLIO_NO, SCH_CODE, MAX(TR_DATE)TR_DATE, TRAN_TYPE, 
             MAX (INVESTOR_NAME) INVESTOR_NAME, MAX (ADDRESS) ADDRESS, 
             MAX (BROKER_CODE) BROKER_CODE, MAX (CITY_NAME) CITY_NAME, MAX(SCH_NAME)SCH_NAME, 
             MAX(MUT_CODE)MUT_CODE, MAX(MUT_NAME)MUT_NAME, MAX(RM_NAME)RM_NAME, MAX(BRANCH_NAME)BRANCH_NAME, MAX (APP_NO) APP_NO, 
             MAX (CHEQUE_NO) CHEQUE_NO, SUM (AMOUNT) AMOUNT, 
             MAX (BUSI_BRANCH_CODE) BUSI_BRANCH_CODE, 
             MAX (BUSINESS_RMCODE) BUSINESS_RMCODE,    
     WEALTHMAKER.GETTRANCODE_ALL(FOLIO_NO,SCH_CODE,TR_DATE,TRAN_TYPE,MAX(TRAN_ID),MAX(UNQ_KEY),'KARVY') UNIQUE_TRAN,   MAX(REG_TRANTYPE) REG_TRANTYPE,max(unq_key) unq_key     FROM (    SELECT t.tran_id,tran_type, t.inv_name Investor_Name,(i.ADDRESS1||','||i.ADDRESS2||','||i.EMAIL) address,            REG_SUBBROK broker_code,c.city_name,            t.sch_code,sch_name sch_name,t.mut_code,amc.mut_name mut_name, rm_name,             branch_name,             app_no,folio_no, cheque_no,   amount,   t.tran_code,reg_date as tr_date,            busi_branch_code, business_rmcode,t.REG_TRANTYPE,t.unq_key unq_key      FROM employee_master e,            branch_master b,            mut_fund amc,            scheme_info sch,            TRANSACTION_ST@MF.BAJAJCAPITAL t,            investor_master i,CITY_MASTER C      WHERE I.CITY_ID=C.CITY_ID(+)        AND t.client_code = i.inv_code        AND to_char(t.rmcode) = e.rm_code        AND t. BRANCH_CODE = b.branch_code          AND t.mut_code = amc.mut_code AND t.sch_code = sch.sch_code   AND  (DUP_FLAG2 = 0 OR (REG_TRAN_FLAG='TI' AND DUP_FLAG2 IN(0,9)))  and b.BRANCH_CODE in (SELECT BRANCH_ID FROM USERDETAILS_JI WHERE LOGIN_ID='112650' AND ROLE_ID='29')  and to_char(t.mut_code) = 'MF057' and (t.rec_flag ='N' or rec_flag is null)  AND ((    UPPER (t.REG_TRANTYPE) NOT LIKE '%SYS%' AND UPPER (t.REG_TRANTYPE) NOT LIKE '%SIP%' AND TRIM(UPPER (t.REG_TRANTYPE)) NOT LIKE '%S T P IN%'  AND TRIM(UPPER (t.REG_TRANTYPE)) NOT LIKE '%S T P IN REJ%' AND TRIM(UPPER (t.REG_TRANTYPE)) NOT LIKE '%S T P IN REJ REVERSAL%' AND TRIM(UPPER (t.REG_TRANTYPE))NOT LIKE '%STP SWITCH IN%' AND TRIM(UPPER (t.REG_TRANTYPE)) NOT LIKE '%STPI%' AND TRIM(UPPER(t.REG_TRANTYPE)) NOT LIKE '%REDEMPTION%' AND TRIM(UPPER(t.REG_TRANTYPE)) NOT LIKE '%PRE-REJECTION%' AND TRIM(UPPER (t.REG_TRANTYPE)) NOT LIKE '%STPIR%' ) OR t.REG_TRANTYPE IS NULL)  AND TR_DATE >= TO_DATE('02-05-2025', 'DD-MM-YYYY') AND TR_DATE <= TO_DATE('02-07-2025', 'DD-MM-YYYY') AND ( (UPPER(t.PAN1) = UPPER('BHCPT9400R') OR UPPER(t.PAN2) = UPPER('BHCPT9400R') OR UPPER(t.PAN3) = UPPER('BHCPT9400R')) ) AND LPAD(t.mut_code, 2) = 'MF'  AND (t.asa <> 'C' OR t.asa IS NULL) AND t.tran_type IN ('PURCHASE', 'REINVESTMENT', 'SWITCH IN')  ORDER BY  TR_Date,rm_name  )  GROUP BY FOLIO_NO,           SCH_CODE,           TR_DATE,           TRAN_TYPE 