SELECT tmf.rec_flag, tmf.SIP_TYPE,
    CASE WHEN tmf.LOGGEDUSERID = 'MFONLINE' THEN 'Online' WHEN tmf.LOGGEDUSERID = 'Valuefy' THEN 'Online' ELSE 'Offline' END AS FLAG,
    tmf.TRAN_CODE,  tmf.PANNO,      tmf.BROKER_ID,  tmf.INVESTOR_NAME,  tmf.SCH_CODE,   si.SCH_NAME,     tmf.MUT_CODE,
    ai.MUT_NAME,    tmf.TRAN_TYPE,  tmf.APP_NO,     tmf.APP_DATE,       tmf.CHEQUE_NO,  tmf.CHEQUE_DATE, tmf.AMOUNT, 
    tmf.SIP_TYPE,   tmf.PAYMENT_MODE, tmf.BANK_NAME, tmf.FOLIO_NO,      tmf.RMCODE,     li.RM_NAME,      tmf.INVESTOR_TYPE, 
    tmf.BRANCH_CODE, ti.BRANCH_NAME, tmf.TR_DATE,   tmf.UNITS,          tmf.NAV_DATE,   tmf.REMARK,      tmf.Sip_Amount,
    tmf.remark_reco, tmf.BROKER_ID, mi.REG_TRANTYPE, tmf.UNIQUE_KEY,    pi.exist_code,  substr(i.ADDRESS1,1,10) as ADDRESS1, 
    c.CITY_NAME,    NVL(tmf.cob_flag, 0) AS cob_flag,  (SELECT REG FROM REG_SCHEMES@MF.BAJAJCAPITAL WHERE MUT_CODE = tmf.MUT_CODE AND ROWNUM = 1) AS REGISTRAR
FROM transaction_mf_temp1 tmf
LEFT JOIN ALLSCHEME si ON tmf.SCH_CODE = si.SCH_CODE
LEFT JOIN MUT_FUND ai ON tmf.MUT_CODE = ai.MUT_CODE
LEFT JOIN BRANCH_MASTER ti ON tmf.BRANCH_CODE = ti.BRANCH_CODE
LEFT JOIN EMPLOYEE_MASTER li ON tmf.RMCODE = li.RM_CODE
LEFT JOIN AGENT_MASTER pi ON tmf.source_code = pi.agent_code
LEFT JOIN INVESTOR_MASTER i ON tmf.CLIENT_CODE = i.INV_CODE
LEFT JOIN CITY_MASTER c ON i.CITY_ID = c.CITY_ID
LEFT JOIN TRANSACTION_ST@MF.BAJAJCAPITAL mi ON tmf.RTA_TRAN_CODE = mi.tran_code
WHERE 1 = 1  
AND tmf.TRAN_TYPE != 'REVERTAL'  
AND tmf.BRANCH_CODE IN (SELECT BRANCH_ID FROM USERDETAILS_JI WHERE LOGIN_ID='112650' AND ROLE_ID='29')  
AND tmf.TR_DATE >= TO_DATE('22-06-2025', 'DD-MM-YYYY') AND tmf.TR_DATE <= TO_DATE('25-06-2025', 'DD-MM-YYYY')                 
--AND NVL(tmf.rec_flag, 'N') = 'N' AND (tmf.SIP_TYPE = 'REGULAR' OR tmf.SIP_TYPE IS NULL) 
AND mi.REG_TRAN_FLAG =  'TI' ORDER BY tmf.TR_DATE