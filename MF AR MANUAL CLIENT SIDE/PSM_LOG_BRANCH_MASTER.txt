CREATE OR REPLACE PROCEDURE WEALTHMAKER.PSM_LOG_BRANCH_MASTER(
P_FOR           IN VARCHAR2,
P_BY            IN VARCHAR2,
P_BY_VALUE      IN VARCHAR2,
P_LOG_ID        IN VARCHAR2,
P_ROLE_ID       IN VARCHAR2,
P_CURSOR         OUT SYS_REFCURSOR

) IS 

BEGIN 

    IF P_FOR = 'MF_AR_MANUAL_RECO' THEN  
        IF P_BY IS NOT NULL THEN
            IF P_BY = 'CHANNEL' THEN
                OPEN P_CURSOR FOR
                    -- BRANCH LIST FOR MF_AR_MANUAL_RECO BY CHANNEL
                    SELECT BRANCH_NAME, BRANCH_CODE FROM BRANCH_MASTER
                    WHERE 1=1
                    AND BRANCH_CODE IN (SELECT BRANCH_ID FROM USERDETAILS_JI WHERE LOGIN_ID = P_LOG_ID AND ROLE_ID=P_ROLE_ID)  
                    AND CATEGORY_ID NOT IN ('1004', '1005', '1006')
                    AND BRANCH_TAR_CAT = P_BY_VALUE
                    ORDER BY BRANCH_NAME;            
            END IF;
        ELSE
            -- BRANCH LIST FOR MF_AR_MANUAL_RECO  
            OPEN P_CURSOR FOR 
                SELECT BRANCH_CODE, BRANCH_NAME FROM BRANCH_MASTER
                WHERE 1=1 
                AND BRANCH_CODE IN (SELECT BRANCH_ID FROM USERDETAILS_JI WHERE LOGIN_ID = P_LOG_ID AND ROLE_ID=P_ROLE_ID)         
                ORDER BY BRANCH_NAME;
        END IF;
    ELSE
        OPEN P_CURSOR FOR 
        SELECT BRANCH_CODE, BRANCH_NAME FROM BRANCH_MASTER
        WHERE 1=1 
        AND BRANCH_CODE IN (SELECT BRANCH_ID FROM USERDETAILS_JI WHERE LOGIN_ID = P_LOG_ID AND ROLE_ID=P_ROLE_ID)        
        ORDER BY BRANCH_NAME;
    END IF;




END ;
/