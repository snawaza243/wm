CREATE OR REPLACE PROCEDURE PSM_UPDATE_DUE_PAID_PREM_FRQ (
    P_LOG           IN VARCHAR2,
    P_IMP_DATA_TYPE IN VARCHAR2
)
AS 
BEGIN
    -- Update Due Data Table
    UPDATE BAJAJ_DUE_DATA
    SET PREM_FREQ = CASE 
        WHEN PREM_FREQ IN ('1', '01', 'ANNUALLY', 'ANNUAL', 'YEARLY') THEN 'ANNUALLY'
        WHEN PREM_FREQ IN ('2', '02', 'SEMI-ANNUALLY', 'SEMIANNUAL', 'SEMI', 'SEMI ANNUAL') THEN 'SEMI-ANNUALLY'
        WHEN PREM_FREQ IN ('4', '04', 'QUARTERLY', 'QUARTER') THEN 'QUARTERLY'
        WHEN PREM_FREQ IN ('12', 'MONTHLY') THEN 'MONTHLY'
        ELSE PREM_FREQ -- Keeps original if no match
    END
    WHERE PREM_FREQ IS NOT NULL
      AND USERID = P_LOG
      AND IMPORTDATATYPE = P_IMP_DATA_TYPE;

    -- Update Paid Data Table
    UPDATE BAJAJ_PAID_DATA
    SET PREM_FREQ = CASE 
        WHEN PREM_FREQ IN ('1', '01', 'ANNUALLY', 'ANNUAL', 'YEARLY') THEN 'ANNUALLY'
        WHEN PREM_FREQ IN ('2', '02', 'SEMI-ANNUALLY', 'SEMIANNUAL', 'SEMI', 'SEMI ANNUAL') THEN 'SEMI-ANNUALLY'
        WHEN PREM_FREQ IN ('4', '04', 'QUARTERLY', 'QUARTER') THEN 'QUARTERLY'
        WHEN PREM_FREQ IN ('12', 'MONTHLY') THEN 'MONTHLY'
        ELSE PREM_FREQ -- Optional: Retain or set NULL as per your logic
    END
    WHERE PREM_FREQ IS NOT NULL
      AND USERID = P_LOG
      AND IMPORTDATATYPE = P_IMP_DATA_TYPE;

    COMMIT;
END;
