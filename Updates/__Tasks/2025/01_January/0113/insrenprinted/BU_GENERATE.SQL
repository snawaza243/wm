create or replace PROCEDURE PSM_GET_COMPANY_DATA_GEN(
    p_company_code IN VARCHAR2,
    p_month IN VARCHAR2,
    p_year IN NUMBER,
    p_cursor OUT SYS_REFCURSOR
)
AS
BEGIN
    OPEN p_cursor FOR
    SELECT 
        COMPANY_CD, 
        STATUS_CD, 
        LOCATION, 
        POLICY_NO, 
        CL_NAME,
        PREM_AMT,
        PAY_MODE,
        DUE_DATE,
        CL_ADD1,
        CL_ADD2,
        CL_ADD3,
        CL_CITY,
        CL_PIN,
        CL_PHONE1,
        CL_PHONE2,
        CL_MOBILE,
        MON_NO,
        YEAR_NO,
        USERID,
        IMPORT_DT,
        EMP_NO,
        INV_CD,
        DUP_REC,
        PLAN_NAME,
        PREM_FREQ,
        DOC,
        BRANCH_CD,
        AR_BRANCH_CD,
        PLY_TERM,
        CL_ADD4,
        CL_ADD5,
        PLAN_NO,
        BPREM_FREQ,
        PREM_TERM,
        LAST_UPDATE_DT,
        LAST_UPDATE,
        FRESH_RENEWAL4,
        SYS_AR_NO,
        MAIL_FLAG,
        SEND_ID,
        SEND_DATE,
        APP_NO,
        MATCHED,
        REN_STATUS,
        REMARKS,
        IMPORTDATATYPE,
        HISTORY,
        SYS_AR_NO_REN,
        AUTOMAP,
        CLIENT_CD,
        INV_CODE,
        P_NAME,
        I_NAME,
        SA,
        REM_FLAGE,
        STATE_CD,
        COMM,
        COMM_AMT,
        BASE_SYS_AR_NO,
        MATCH_HEADER,
        CPREM_FREQ,
        MATCH_HEADER1,
        NEWINSERT,
        SLOT,
        TALISMA_FLAG,
        MARGIN4,
        SMS_FLAG,
        FORCE_FLAG,
        UPD_FLAG,
        PLAN_UPD,
        FREQ_UPD,
        ACTIVE_CLIENT,
        P_ADD1,
        P_ADD2,
        P_CITY,
        P_STATE_CD,
        P_PIN,
        IADD1,
        IADD2,
        ICITY,
        ISTATE_CD,
        IPIN,
        PLAN_RATE4,
        PAID_MONTH_YEAR,
        STATUS_CD_OLD,
        FREQ,
        FRESH_RENEWAL,
        MARGIN,
        PLAN_RATE,
        RENEWAL_STATUS,
        FLAG_13M,
        ECS_DATE,
        NEW_STATUS_CD
    FROM bajaj_due_data
    WHERE COMPANY_CD = p_company_code
      AND TO_CHAR(DUE_DATE, 'MM') = p_month
      AND TO_CHAR(DUE_DATE, 'YYYY') = p_year;
END PSM_GET_COMPANY_DATA_GEN;